---
title: "data preparation 6 - 10 / 3 / 2023"
output:
  pdf_document: default
---

# Script per la preparazione dei dati

```{r include=FALSE}
library(tidyverse)
library(readxl)
```
 
 
```{r}


cols_to_keep <-  c("Giorno",
                   "Comune di partenza", 
                   "Comune di arrivo", 
                   "Tipologia viaggiatore",       
                   "Viaggi",        
                   "00-03", 
                   "03-06", 
                   "06-09", 
                   "09-12", 
                   "12-15", 
                   "15-18", 
                   "18-21", 
                   "21-24")
```
 
```{r}
#read data and filter relevant columns
df <- read_excel('./data/EXPORT FVG _ 6-10 MARZO 2023.xlsx')  %>% 
    select(all_of(cols_to_keep))

# remove whitespace in column names
colnames(df) <- gsub(" ", "_", colnames(df))

print(df)
 
```

```{r}
# filter relevant rows
print("BEROFRE filtering:")
table(df$Tipologia_viaggiatore)

rows_to_keep <- c(
    'Residente Comunale diretto in altro Comune di Provincia di residenza',
    'Residente Comunale di ritorno da altro Comune di Provincia di residenza')

df <- df %>% 
    filter(Tipologia_viaggiatore %in% rows_to_keep)
print("AFTER filtering:")
table(df$Tipologia_viaggiatore)
```

```{r}
df %>% write.csv("dati_6_10_marzo_2023.csv")
```


